<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Psychological Test</title>
<style>
  body {
    background: linear-gradient(to right, #e0f7fa, #e1bee7);
    font-family: 'Segoe UI', sans-serif;
    text-align: center;
    padding: 40px;
    margin: 0;
    display: flex;
    flex-direction: column;
    align-items: center;
    min-height: 100vh;
    overflow-x: hidden;
  }

  #progress-bar {
    width: 80%;
    height: 10px;
    background: #ccc;
    border-radius: 5px;
    margin-top: 20px;
    overflow: hidden;
  }
  #progress {
    height: 100%;
    width: 0%;
    background: #4db6ac;
    transition: width 0.5s ease;
  }

  .container {
    position: relative;
    perspective: 1000px;
    width: 90%;
    max-width: 600px;
    margin: 30px 0;
  }

  .card {
    width: 100%;
    height: 300px;
    background: white;
    border-radius: 10px;
    box-shadow: 0 8px 20px rgba(0,0,0,0.1);
    position: relative;
    transform-style: preserve-3d;
    transition: transform 0.8s;
    cursor: pointer;
  }

  .card.flip {
    transform: rotateY(180deg);
  }

  .card-front, .card-back {
    position: absolute;
    width: 100%;
    height: 100%;
    backface-visibility: hidden;
    padding: 30px;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    font-size: 20px;
    border-radius: 10px;
  }

  .card-front {
    background: #ffffff;
  }

  .card-back {
    background: #c5cae9;
    transform: rotateY(180deg);
  }

  .options {
    margin-top: 30px;
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
  }

  .options button {
    background: #ffffffaa;
    border: none;
    padding: 10px 20px;
    margin: 10px;
    border-radius: 20px;
    font-size: 16px;
    cursor: pointer;
    transition: background 0.3s;
  }

  .options button:hover {
    background: #4db6ac;
    color: white;
  }

  #navigation {
    margin-top: 20px;
  }

  #navigation button, #submitBtn {
    background: #4db6ac;
    border: none;
    color: white;
    padding: 10px 20px;
    border-radius: 20px;
    font-size: 16px;
    margin: 5px;
    cursor: pointer;
    transition: background 0.3s;
  }

  #navigation button:hover, #submitBtn:hover {
    background: #00796b;
  }

</style>
</head>
<body>

<div id="progress-bar"><div id="progress"></div></div>

<div class="container" onclick="flipCard()">
  <div class="card" id="card">
    <div class="card-front" id="question">Loading...</div>
    <div class="card-back" id="explanation">Loading explanation...</div>
  </div>
</div>

<div class="options" id="options"></div>

<div id="navigation">
  <button onclick="prevQuestion()">Previous</button>
  <button onclick="nextQuestion()">Next</button>
</div>

<button onclick="submitAnswers()" id="submitBtn" style="display:none;">Submit</button>

<script>
let currentIndex = 0;
let email = "";
let questions = [
  "Please enter your email:\n\n(A welcome text and a text saying 'Click me to see further information')",
  "The anticipation of future rewards motivates me more than receiving immediate rewards",
  "I can maintain motivation by visualizing longterm benefits of my actions",
  "I find myself seeking immediate rewards, even if I know a better reward will come later",
  "I often need external incentives (praise, rewards) to stay motivated",
  "I get energized by planning steps toward a distant goal",
  "I tend to abandon tasks when the rewards aren't immediately visible",
  "Once I've established a routine, I can maintain it without much conscious effort",
  "I can stick to new habits even when facing obstacles or stress",
  "I struggle to maintain consistency in my daily routines",
  "I often start strong with new habits but rarely maintain them longterm",
  "My positive habits feel natural and automatic rather than forced",
  "I tend to forget or abandon habits if I don't see immediate results",
  "I consciously align my daily habits with my longterm goals",
  "When I recognize a habit isn't serving me, I can successfully modify it",
  "I sometimes find myself repeating behaviors that conflict with my goals",
  "I find it difficult to break habits even when I know they're counterproductive",
  "I regularly evaluate and adjust my habits based on their effectiveness",
  "I often act on autopilot without considering the longterm impact of my habits",
  "Thank you after submission" // <- Added final card
];

let explanations = [
  "Please type your email address so we can save your answers.",
  "Motivation can be increased by imagining the benefits of future success.",
  "Thinking about longterm goals helps in maintaining daily motivation.",
  "Seeking quick rewards can interfere with achieving bigger future goals.",
  "External incentives can sometimes be necessary for motivation.",
  "Planning energizes and makes distant goals feel achievable.",
  "Tasks can feel less rewarding if results aren't immediate.",
  "Strong routines can carry you through even on low motivation days.",
  "Consistency helps in forming long-lasting positive habits.",
  "Struggles with daily consistency can derail even strong goals.",
  "Longterm maintenance of habits is key to transformation.",
  "Habits become automatic through repetition and positive reinforcement.",
  "Immediate results can drive persistence, but patience is vital.",
  "Daily alignment with big goals creates purpose and direction.",
  "Recognizing and changing ineffective habits is a strength.",
  "Self-awareness is needed to overcome goal-conflicting behaviors.",
  "Breaking bad habits is hard but possible with effort.",
  "Continuous evaluation ensures your habits remain effective.",
  "Autopilot behavior can be either beneficial or harmful depending on the habit.",
  "Test part 2 and 3" // <- Explanation for the final card
];

let answers = {};

function loadQuestion() {
  const card = document.getElementById('card');
  card.classList.remove('flip');

  document.getElementById('question').innerText = questions[currentIndex];
  document.getElementById('explanation').innerText = explanations[currentIndex];

  const optionsDiv = document.getElementById('options');
  optionsDiv.innerHTML = '';

  if(currentIndex === 0) {
    optionsDiv.innerHTML = `<input type="email" id="emailInput" placeholder="Enter your email" style="padding:10px; font-size:16px; width:80%;">`;
  } else if(currentIndex < questions.length - 1) {
    let options = ["Strongly Agree", "Agree", "Neutral", "Disagree", "Strongly Disagree"];
    options.forEach(opt => {
      const btn = document.createElement('button');
      btn.innerText = opt;
      btn.onclick = () => selectAnswer(opt);
      optionsDiv.appendChild(btn);
    });
  } else {
    // Last card: Thank you message
    document.getElementById('options').innerHTML = '';
    document.getElementById('navigation').style.display = "none";
    document.getElementById('submitBtn').style.display = "inline-block";
  }

  updateProgress();
}

function flipCard() {
  document.getElementById('card').classList.toggle('flip');
}

function selectAnswer(option) {
  answers[`q${currentIndex}`] = option;
  nextQuestion();
}

function nextQuestion() {
  if(currentIndex === 0){
    email = document.getElementById('emailInput').value;
    if(!validateEmail(email)){
      alert("Please enter a valid email address.");
      return;
    }
  }
  currentIndex++;
  if(currentIndex >= questions.length){
    return;
  }
  loadQuestion();
}

function prevQuestion() {
  if(currentIndex > 0){
    currentIndex--;
    loadQuestion();
  }
}

function updateProgress(){
  let progress = Math.floor((currentIndex / (questions.length-1)) * 100);
  document.getElementById('progress').style.width = `${progress}%`;
}

function validateEmail(mail) {
  return /\S+@\S+\.\S+/.test(mail);
}

function submitAnswers() {
  if(!validateEmail(email)){
    alert("Invalid email address. Please correct it before submitting.");
    return;
  }

  const payload = {
    email: email,
    answers: answers
  };
  const url = "https://script.google.com/macros/s/AKfycbyr1tYZ2gW29jkogPD1PgfY2J7tC044ext2lehs9TFuPWgeiWXxlpITSrC0icIQvYogSA/exec";

  fetch(url, {
    method: "POST",
    mode: "no-cors",
    headers: {
      "Content-Type": "application/json"
    },
    body: JSON.stringify(payload)
  }).then(res => {
    alert("Submitted successfully!");
  }).catch(err => {
    console.error(err);
  });
}

loadQuestion();
</script>

</body>
</html>
