<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Responsive Quiz Card</title>
  <style>
    * { box-sizing: border-box; }
    html, body {
      height: 100%;
      margin: 0;
      padding: 0;
      font-family: Arial, sans-serif;
      background: linear-gradient(to right, #e0f7fa, #e1bee7);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
      overflow-x: hidden;
    }
    body {
      padding: 20px;
    }

    .card-container {
      width: 100%;
      max-width: 500px;
      margin: 20px 0;
      perspective: 1000px;
    }

    .card {
      width: 100%;
      min-height: 50vh;
      background: white;
      border-radius: 15px;
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
      cursor: pointer;
      position: relative;
      overflow: hidden;
    }

    .card-inner {
      width: 100%;
      height: 100%;
      transition: transform 0.8s;
      transform-style: preserve-3d;
      position: absolute;
      top: 0; left: 0;
      border-radius: 15px;
    }

    .card-inner.flip {
      transform: rotateY(180deg);
    }

    .card-face {
      width: 100%;
      height: 100%;
      position: absolute;
      backface-visibility: hidden;
      border-radius: 15px;
      padding: 30px;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      text-align: center;
      font-size: 1.2em;
      overflow-y: auto;
    }

    .card-front {
      background: white;
      color: #333;
      z-index: 2;
    }

    .card-back {
      background: #c5cae9;
      color: #333;
      transform: rotateY(180deg);
    }

    #card-content, #backside-content {
      margin-bottom: 20px;
      font-weight: bold;
      word-break: break-word;
    }

    .options, #navigation {
      margin-top: 20px;
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      justify-content: center;
    }

    button {
      padding: 10px 20px;
      font-size: 1em;
      border: none;
      border-radius: 25px;
      background-color: #4db6ac;
      color: white;
      cursor: pointer;
      transition: background-color 0.3s, transform 0.2s;
    }
    button:hover {
      background-color: #26a69a;
      transform: translateY(-2px);
    }
    button.selected {
      background-color: #00796b;
    }

    #status {
      margin-top: 20px;
      font-weight: bold;
      min-height: 1.5em;
      text-align: center;
      width: 100%;
      max-width: 500px;
      color: #222;
    }

    /* Mobile responsiveness */
    @media (max-width: 600px) {
      .card {
        min-height: 60vh;
      }
      .card-face {
        font-size: 1em;
        padding: 20px;
      }
      button {
        font-size: 0.9em;
        padding: 8px 16px;
      }
    }

    @media (max-width: 400px) {
      .card {
        min-height: 65vh;
      }
      .card-face {
        font-size: 0.9em;
        padding: 15px;
      }
    }

  </style>
</head>
<body>

<div class="card-container">
  <div class="card" onclick="flipCard()">
    <div class="card-inner" id="card-inner">
      <div class="card-face card-front">
        <div id="card-content">Loading...</div>
        <div class="options" id="options"></div>
      </div>
      <div class="card-face card-back">
        <div id="backside-content">Backside text</div>
      </div>
    </div>
  </div>
</div>

<div id="navigation"></div>
<p id="status"></p>

<script>
  let currentIndex = 0;
  let answers = {};

  const cardContents = [
    "Welcome to the Simple Test!",
    "Question One: Is the sky blue?",
    "Question Two: Is water wet?",
    "Question Three: Does 1+1=2?",
    "Finished! Ready to submit?"
  ];
  const backsideText = "Flip me to see more!";

  const cardInner = document.getElementById('card-inner');
  const cardContentDiv = document.getElementById('card-content');
  const backsideContentDiv = document.getElementById('backside-content');
  const optionsDiv = document.getElementById('options');
  const navigationDiv = document.getElementById('navigation');
  const statusP = document.getElementById('status');

  const scriptURL = 'https://script.google.com/macros/s/AKfycbzzEEBrO7ORxw8kzLbVKrEt7x_4_1ZEwU9IuRMY9HMk6p_uTjM9k8V4ZINfcvI-4CBM/exec';

  function loadCard(index) {
    currentIndex = index;
    cardInner.classList.remove('flip');
    setTimeout(() => {
      cardContentDiv.textContent = cardContents[index];
      backsideContentDiv.textContent = backsideText;
    }, 100);

    optionsDiv.innerHTML = '';
    navigationDiv.innerHTML = '';
    statusP.textContent = '';

    if (index > 0) {
      const prevBtn = document.createElement('button');
      prevBtn.textContent = 'Previous';
      prevBtn.onclick = (e) => { e.stopPropagation(); prevCard(); };
      navigationDiv.appendChild(prevBtn);
    }

    if (index === 0) {
      const nextBtn = document.createElement('button');
      nextBtn.textContent = 'Next';
      nextBtn.onclick = (e) => { e.stopPropagation(); nextCard(); };
      navigationDiv.appendChild(nextBtn);
    } else if (index >= 1 && index <= 3) {
      const questionKey = 'q' + index;
      ['Yes', 'No'].forEach(option => {
        const btn = document.createElement('button');
        btn.textContent = option;
        btn.onclick = (e) => { e.stopPropagation(); selectAnswer(index, option); };
        optionsDiv.appendChild(btn);
        if (answers[questionKey] === option) {
          btn.classList.add('selected');
        }
      });
    } else if (index === 4) {
      const submitBtn = document.createElement('button');
      submitBtn.id = 'submitBtn';
      submitBtn.textContent = 'Submit Answers';
      submitBtn.onclick = (e) => { e.stopPropagation(); submitData(); };
      navigationDiv.appendChild(submitBtn);
    }
  }

  function flipCard() {
    cardInner.classList.toggle('flip');
  }

  function selectAnswer(index, option) {
    answers['q' + index] = option;
    const buttons = optionsDiv.querySelectorAll('button');
    buttons.forEach(btn => {
      btn.classList.toggle('selected', btn.textContent === option);
    });
    setTimeout(() => {
      if (currentIndex < cardContents.length - 1) {
        nextCard();
      }
    }, 250);
  }

  function nextCard() {
    if (currentIndex < cardContents.length - 1) {
      loadCard(currentIndex + 1);
    }
  }

  function prevCard() {
    if (currentIndex > 0) {
      loadCard(currentIndex - 1);
    }
  }

  function submitData() {
    const submitBtn = document.getElementById('submitBtn');
    statusP.textContent = 'Submitting...';
    statusP.style.color = 'black';
    if (submitBtn) submitBtn.disabled = true;

    fetch(scriptURL, {
      redirect: "follow",
      method: 'POST',
      headers: {
        'Content-Type': 'text/plain;charset=utf-8',
      },
      body: JSON.stringify(answers)
    })
    .then(response => response.ok ? response.json() : Promise.reject(response))
    .then(data => {
      if (data && data.result === 'success') {
        statusP.textContent = 'Success! Data submitted.';
        statusP.style.color = 'green';
        document.querySelector('.card-container').style.display = 'none';
        navigationDiv.style.display = 'none';
      } else {
        statusP.textContent = 'Error submitting data.';
        statusP.style.color = 'red';
        if (submitBtn) submitBtn.disabled = false;
      }
    })
    .catch(error => {
      console.error('Submission failed:', error);
      statusP.textContent = 'Error during submission. Check console.';
      statusP.style.color = 'red';
      if (submitBtn) submitBtn.disabled = false;
    });
  }

  window.onload = () => {
    loadCard(0);
  };
</script>

</body>
</html>
