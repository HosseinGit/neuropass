<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Motivation & Habit Assessment</title>
        <style>
        /* --- Modern Font & Basic Reset --- */
        * { box-sizing: border-box; margin: 0; padding: 0; }
        html { height: 100%; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
            line-height: 1.6;
            background-color: #ffffff;
            padding: 1px 1px;
            overflow-x: hidden;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100%;
        }

        /* --- Card Container & Perspective --- */
        .card-container {
            width: 90%;
            height: 90%;
            max-width: 460px;
            max-height:580px;
            margin: auto;
            perspective: 1200px;
            margin-top: 25px;
            margin-bottom: 5px;
        }

        /* --- Card Structure (Outer Shell) --- */
        .card {
            min-height: 540px;
            position: relative;
            cursor: pointer;
        }

        /* --- Card Inner (Handles the Flip) --- */
        .card-inner {
            width: 100%;
            height: 100%;
            position: absolute;
            top: 0;
            left: 0;
            transform-style: preserve-3d;
            transition: transform 0.7s cubic-bezier(0.4, 0, 0.2, 1);
            border-radius: 16px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
        }
        .card-inner.flip {
            transform: rotateY(180deg);
        }

        /* --- Card Faces (Front and Back) --- */
        .card-face {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            border-radius: 16px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center; /* Center content vertically */
             /* Adjusted padding to make space for progress bar */
            padding: 40px 25px 30px 25px;
            text-align: center;
            overflow: hidden; /* Hide potential overflow from content */
             /* overflow-wrap: break-word; */ /* This might conflict with centering */
            /* overflow-y: auto; */ /* Avoid scrollbars if possible */
        }
        .card-front {
            background: #ffffff;
            color: #333;
            z-index: 2;
        }
        .card-back {
            background: #424242;
            color: white;
            transform: rotateY(180deg);
             justify-content: center;
        }

         /* --- NEW: Progress Bar Styling --- */
        .progress-bar-container {
            position: absolute; /* Position relative to card-face */
            top: 15px; /* Position near the top, respecting padding */
            left: 25px; /* Align with horizontal padding */
            right: 25px; /* Align with horizontal padding */
            width: calc(100% - 50px); /* Full width minus padding */
            height: 20px;
            background-color: #eeeeee; /* Light grey track */
            border-radius: 10px;
            overflow: hidden;
            z-index: 3; /* Ensure it's above card background */
        }
        .progress-bar-fill {
            height: 100%;
            width: 0%; /* Starts empty, filled by JS */
            background-color: #00b8d4; /* Light teal/blue-green */
            border-radius: 10px;
            transition: width 0.4s ease-out; /* Smooth animation */
        }
        /* Hide on back face if absolutely positioned (though display:none in JS is better) */
        .card-back .progress-bar-container {
             display: none;
        }

        /* --- Content Wrapper (To handle potential overflow) --- */
         .card-content-wrapper {
            width: 100%;
            overflow-y: auto; /* Allow scrolling ONLY for content if needed */
            display: flex;
            flex-direction: column;
            align-items: center;
            /* flex-grow: 1; /* Allow wrapper to take space */
         }


        /* --- Content Inside Front Face --- */
        #card-content {
             font-weight: 500;
             font-size: 1.2em;
             line-height: 1.4;
             max-width: 100%;
             color: #222;
             margin-bottom: 5px; /* Closer to options */
             /* Removed flex stuff, handled by wrapper */
             width: 100%; /* Ensure it takes width within wrapper */
        }
        #backside-content {
            max-width: 100%;
            font-size: 1.1em;
            line-height: 1.5;
            padding: 30px 25px; /* Ensure back has its own padding if progress bar isn't shown */
            overflow-y: auto;
        }

        /* --- Specific Welcome Card Text Styling --- */
        .welcome-title { font-size: 2.2em; font-weight: bold; margin-bottom: 15px; }
        .welcome-sub { font-size: 1.1em; margin-bottom: 15px; }
        .welcome-hint { font-size: 0.9em; font-style: italic; color: #777; }


        /* --- Email Input Styling --- */
        #email-input-container {
             margin-top: 5px; /* Closer to text above */
             margin-bottom: 15px;
             width: 100%; max-width: 300px; display: flex; justify-content: center;
         }
        #email-input { width: 100%; padding: 12px 18px; border: 1px solid #e0e0e0; border-radius: 10px; font-size: 1em; text-align: center; background-color: #f9f9f9; transition: border-color 0.2s, box-shadow 0.2s; }
        #email-input:focus { outline: none; border-color: #bdbdbd; box-shadow: 0 0 0 3px rgba(77, 182, 172, 0.2); }

        /* --- Options Buttons Styling --- */
        .options {
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
            padding: 0 10px;
            margin-top: 10px; /* Space above options */
            flex-shrink: 0; /* Prevent options from shrinking */
        }

        /* --- Styling for Option Rows --- */
        .options-row { display: flex; width: 100%; max-width: 380px; }
        .options-row-1, .options-row-2 { justify-content: space-between; }
        .options-row-3 { justify-content: center; }

        /* --- Shared Button Styling --- */
        .options button, #navigation button {
            padding: 10px 15px; font-size: 0.9em; font-weight: 500; border: none; border-radius: 8px;
            cursor: pointer; transition: background-color 0.2s, transform 0.1s, box-shadow 0.2s;
            flex-shrink: 0; box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            background-color: #f5f5f5; color: #555;
            min-width: 80px; text-align: center;
        }
        .options-row-1 button, .options-row-2 button { flex-basis: 48%; }

        .options button:hover { background-color: #e0e0e0; transform: translateY(-1px); box-shadow: 0 4px 8px rgba(0,0,0,0.07); }
        .options button.selected { background-color: #4db6ac; color: white; box-shadow: 0 1px 3px rgba(0,0,0,0.1); transform: translateY(0); }
        .options button:active { transform: translateY(1px); box-shadow: 0 1px 3px rgba(0,0,0,0.1); }

        /* --- Navigation Buttons --- */
        #navigation { margin-top: 5px; display: flex; justify-content: center; gap: 15px; width: 90%; max-width: 480px; margin-left: auto; margin-right: auto; flex-wrap: wrap; margin-bottom: 5px; }
        #navigation button { padding: 10px 22px; font-size: 0.95em; background-color: #4db6ac; color: white; box-shadow: 0 3px 8px rgba(77, 182, 172, 0.3); border-radius: 10px;}
        #navigation button:hover { background-color: #26a69a; transform: translateY(-1px); box-shadow: 0 5px 12px rgba(77, 182, 172, 0.4); }
        #navigation button:disabled { background-color: #bdbdbd; color: #757575; cursor: not-allowed; box-shadow: none; transform: translateY(0); }
        #navigation button:active { transform: translateY(1px); box-shadow: 0 1px 3px rgba(0,0,0,0.1); }

        /* --- Status Message --- */
        #status { margin-top: 10px; font-weight: 500; min-height: 1.5em; color: #333; text-align: center; width: 90%; max-width: 480px; margin-left: auto; margin-right: auto; margin-bottom: 10px; line-height: 1.5; }

        /* --- Responsive --- */
        @media (max-width: 600px) {
            body { padding: 5px 5px; }
            .card-container { width: 95%; max-width: 95%; }
            .card { min-height: 560px; }
             /* Adjusted padding for progress bar */
            .card-face { padding: 35px 15px 20px 15px; }
            .progress-bar-container { top: 10px; left: 15px; right: 15px; width: calc(100% - 30px); }

            #card-content { font-size: 1.1em; margin-bottom: 5px; }
            .options { margin-top: 10px; }
            .welcome-title { font-size: 2em; }
            .welcome-sub { font-size: 1.05em; }
            .welcome-hint { font-size: 0.85em; }
            #navigation { margin-top: 5px; max-width: 95%;}
            #status { max-width: 95%; }
            .options button { font-size: 0.85em; padding: 8px 10px; }
            .options-row { max-width: 100%; }
        }
        @media (max-width: 400px) {
            .card { min-height: 480px; }
            .card-face { padding: 30px 10px 15px 10px; }
             .progress-bar-container { top: 8px; left: 10px; right: 10px; width: calc(100% - 20px); height: 6px; }
             .progress-bar-fill { border-radius: 3px; }
             .progress-bar-container { border-radius: 3px; }


            #card-content { font-size: 1.05em; }
            .welcome-title { font-size: 1.8em; }
            .welcome-sub { font-size: 1em; }
            .welcome-hint { font-size: 0.8em; }
            #email-input { max-width: 90%; }
             .options button { font-size: 0.8em; padding: 8px 5px; min-width: 65px;}
             .options-row-1 button, .options-row-2 button { flex-basis: 47%; }
        }

    </style>
</head>
<body>

    <!-- HTML Structure -->
    <div class="card-container">
        <div class="card" id="main-card">
            <div class="card-inner" id="card-inner">
                <div class="card-face card-front" id="card-front-content">
                    <!-- Progress bar added dynamically here -->
                    <!-- Content wrapper added dynamically here -->
                       <!-- #card-content added dynamically -->
                       <!-- #email-input-container added dynamically -->
                       <!-- #options added dynamically -->
                </div>
                <div class="card-face card-back">
                    <div id="backside-content"></div> <!-- Backside content still loaded here -->
                </div>
            </div>
        </div>
    </div>

    <div id="navigation"></div>
    <p id="status"></p>

    <script>
        // --- State Variables ---
        let currentIndex = 0;
        let userEmail = '';
        let answers = {};

        // --- Content Arrays ---
        const statementContents = [ /* Your full array here */
            "WELCOME CARD PLACEHOLDER", "THIS SHOULD NOT BE DISPLAYED (Email Placeholder)",
            "The anticipation of future rewards motivates me more than receiving immediate rewards", "I can maintain motivation by visualizing longterm benefits of my actions",
            "I find myself seeking immediate rewards, even if I know a better reward will come later", "I often need external incentives (praise, rewards) to stay motivated",
            "I get energized by planning steps toward a distant goal", "I tend to abandon tasks when the rewards aren't immediately visible",
            "Once I've established a routine, I can maintain it without much conscious effort", "I can stick to new habits even when facing obstacles or stress",
            "I struggle to maintain consistency in my daily routines", "I often start strong with new habits but rarely maintain them longterm",
            "My positive habits feel natural and automatic rather than forced", "I tend to forget or abandon habits if I don't see immediate results",
            "I consciously align my daily habits with my longterm goals", "When I recognize a habit isn't serving me, I can successfully modify it",
            "I sometimes find myself repeating behaviors that conflict with my goals", "I find it difficult to break habits even when I know they're counterproductive",
            "I regularly evaluate and adjust my habits based on their effectiveness", "I often act on autopilot without considering the longterm impact of my habits",
            "Finished! Ready to submit?"
         ];
         const backsideContents = [ /* Your full array here */
            "Every response you give reveals part of how your motivation system operates. This isn’t about maximizing pleasure — it’s about building self-awareness and balance. The statements ahead explore how you pursue goals, manage impulses, and respond to rewards. Tap each card to read the psychological and neurological context. Insight begins with understanding, not judgment.", 
             "Back text for email card",
            "Do you get more excited about what's coming eventually than what you can have right now? Like saving up for something big rather than buying small treats.",
            "Can picturing a great outcome in your mind help you stay on track? Like imagining being fit helps you exercise today.",
            "Do you grab what feels good now instead of waiting for something better? Like eating candy now instead of saving room for a special dinner.",
            "Do you need others to cheer you on or give you something to keep going? Like only cleaning your room when promised a treat afterward.",
            "Does mapping out how to achieve something big give you energy? Like feeling excited when planning a future trip.",
            "Do you quit when you can't see quick results? Like stopping a diet after a week because the scale hasn't moved.",
            "Can you keep doing something without thinking about it once it becomes familiar? Like automatically brushing teeth before bed.",
            "Can you keep up new behaviors when life gets tough? Like still taking walks despite a busy week.",
            "Is it hard to do the same things reliably each day? Like having bedtimes that change wildly throughout the week.",
            "Do you begin new things with energy but fade out quickly? Like downloading a meditation app but using it for just two weeks.",
            "Do good behaviors feel like \"just what you do\" rather than a chore? Like drinking water throughout the day without reminders.",
            "Do you stop doing helpful things if they don't pay off quickly? Like quitting an exercise because you don't feel stronger after a week.",
            "Do you choose everyday actions that support your bigger dreams? Like practicing guitar daily to eventually play in a band.",
            "Can you change behaviors that aren't working well? Like switching from late-night scrolling to reading before sleep.",
            "Do you catch yourself doing things that work against what you want? Like snacking while trying to eat healthier.",
            "Is it tough to stop doing familiar things even when they cause problems? Like checking your phone despite needing to focus.",
            "Do you check if your routines are actually helping you and make changes? Like noticing a morning walk improves your mood more than morning TV.",
            "Do you do things without thinking about future effects? Like grabbing fast food regularly without considering health impacts.",
            "Back text for last card"
         ];

        // --- Constants ---
        const TOTAL_CARDS = statementContents.length;
        const NUM_STATEMENTS = 18;
        const TOTAL_PROGRESS_STEPS = NUM_STATEMENTS + 1; // 18 statements + 1 finish card
        const scriptURL = 'https://script.google.com/macros/s/AKfycbz9k2l6LPG-N7Ql88iCuwp-y_f-pn2WZUihAsj8evIQYYrpocdzFaKBB8U84ZL_XmskzQ/exec';

        // --- DOM Elements ---
        const cardElement = document.getElementById('main-card');
        const cardInner = document.getElementById('card-inner');
        const cardFrontContentEl = document.getElementById('card-front-content');
        const backsideContentDiv = document.getElementById('backside-content');
        const navigationDiv = document.getElementById('navigation');
        const statusP = document.getElementById('status');


        // --- Core Functions ---

        function flipCard() {
            cardInner.classList.toggle('flip');
        }

        function loadCard(index) {
            currentIndex = index;
            if (cardInner) { cardInner.classList.remove('flip'); }

            setTimeout(() => {
                if (!cardFrontContentEl || !backsideContentDiv || !navigationDiv || !statusP) {
                    console.error("Essential DOM elements missing!"); return;
                }
                cardFrontContentEl.innerHTML = ''; // Clear previous front content

                // --- Create Progress Bar (Conditionally) ---
                let progressBarFill = null; // To hold reference to the fill element
                if (index >= 2 && index < TOTAL_CARDS) { // Show from statement 1 (index 2) to finish card (index 20)
                    const progressBarContainer = document.createElement('div');
                    progressBarContainer.className = 'progress-bar-container';
                    progressBarFill = document.createElement('div'); // Assign to outer variable
                    progressBarFill.className = 'progress-bar-fill';

                    // Calculate progress percentage
                    const currentStep = index - 1; // Step 1 for index 2, Step 19 for index 20
                    const progressPercent = (currentStep / TOTAL_PROGRESS_STEPS) * 100;
                    progressBarFill.style.width = `${progressPercent}%`;

                    progressBarContainer.appendChild(progressBarFill);
                    cardFrontContentEl.appendChild(progressBarContainer); // Add bar FIRST
                }

                // --- Create Content Wrapper ---
                const contentWrapper = document.createElement('div');
                contentWrapper.className = 'card-content-wrapper';
                cardFrontContentEl.appendChild(contentWrapper); // Add wrapper AFTER bar

                // --- Create inner structure INSIDE wrapper ---
                const contentDiv = document.createElement('div');
                contentDiv.id = 'card-content';
                contentWrapper.appendChild(contentDiv);

                let emailContainer = null;
                if (index === 1) {
                    emailContainer = document.createElement('div');
                    emailContainer.id = 'email-input-container';
                    const emailInput = document.createElement('input');
                    // ... email input setup ...
                    emailInput.type = 'email'; emailInput.id = 'email-input';
                    emailInput.placeholder = 'Enter your email address';
                    emailInput.required = true; emailInput.value = userEmail;
                    emailInput.onclick = (e) => e.stopPropagation();
                    emailContainer.appendChild(emailInput);
                    contentWrapper.appendChild(emailContainer); // Append email inside wrapper
                }

                const optionsDiv = document.createElement('div');
                optionsDiv.className = 'options';
                optionsDiv.id = 'options';
                contentWrapper.appendChild(optionsDiv); // Append options inside wrapper

                // --- Populate content ---
                if (backsideContents[index] !== undefined) {
                    backsideContentDiv.textContent = backsideContents[index];
                } else { backsideContentDiv.textContent = "Back text missing."; }

                navigationDiv.innerHTML = '';
                statusP.textContent = '';

                // --- Logic based on index ---
                if (index === 0) { // WELCOME
                    // ... welcome text setup ...
                    const title = document.createElement('div'); title.className = 'welcome-title'; title.textContent = 'Welcome!'; contentDiv.appendChild(title);
                    const subText = document.createElement('div'); subText.className = 'welcome-sub'; subText.textContent = 'This experience is designed to help you understand how your brain — especially your dopamine system and basal ganglia — shapes your habits, focus, and emotional patterns.'; contentDiv.appendChild(subText);
                    const hintText = document.createElement('div'); hintText.className = 'welcome-hint'; hintText.textContent = 'Don’t just stand there — flip me!'; contentDiv.appendChild(hintText);
                    optionsDiv.style.display = 'none';
                    const nextBtn = document.createElement('button'); nextBtn.textContent = 'Next'; nextBtn.onclick = (e) => { e.stopPropagation(); nextCard(); }; navigationDiv.appendChild(nextBtn);

                } else if (index === 1) { // EMAIL
                    contentDiv.textContent = 'Please enter your email address to proceed!';
                    // Email input added above
                    optionsDiv.style.display = 'none';
                     // ... nav buttons setup ...
                    const prevBtn = document.createElement('button'); prevBtn.textContent = 'Previous'; prevBtn.onclick = (e) => { e.stopPropagation(); prevCard(); }; navigationDiv.appendChild(prevBtn);
                    const startBtn = document.createElement('button'); startBtn.textContent = 'Start Assessment';
                    startBtn.onclick = (e) => {
                         e.stopPropagation();
                         const emailValue = document.getElementById('email-input').value.trim();
                         if (validateEmail(emailValue)) { userEmail = emailValue; nextCard(); }
                         else { statusP.textContent = 'Please enter a valid email address.'; statusP.style.color = '#d32f2f'; try { document.getElementById('email-input').focus(); } catch(err){} }
                    };
                    navigationDiv.appendChild(startBtn);


                } else if (index >= 2 && index <= NUM_STATEMENTS + 1) { // STATEMENTS
                    if (statementContents[index] !== undefined) {
                         contentDiv.textContent = statementContents[index];
                    } else { contentDiv.textContent = "Statement missing."; }
                     // ... options buttons setup ...
                    const optionsList = ["Strongly disagree", "Disagree", "Neutral", "Agree", "Strongly agree"];
                    const selectedValue = answers['s' + (index - 1)];
                    const createOptionButton = (optionText) => {
                         const btn = document.createElement('button'); btn.textContent = optionText;
                         btn.onclick = (e) => { e.stopPropagation(); selectAnswer(index, optionText); };
                         if (selectedValue === optionText) { btn.classList.add('selected'); }
                         return btn;
                    };
                    const row1 = document.createElement('div'); row1.className = 'options-row options-row-1'; row1.appendChild(createOptionButton(optionsList[0])); row1.appendChild(createOptionButton(optionsList[4])); optionsDiv.appendChild(row1);
                    const row2 = document.createElement('div'); row2.className = 'options-row options-row-2'; row2.appendChild(createOptionButton(optionsList[1])); row2.appendChild(createOptionButton(optionsList[3])); optionsDiv.appendChild(row2);
                    const row3 = document.createElement('div'); row3.className = 'options-row options-row-3'; row3.appendChild(createOptionButton(optionsList[2])); optionsDiv.appendChild(row3);

                    const prevBtn = document.createElement('button'); prevBtn.textContent = 'Previous'; prevBtn.onclick = (e) => { e.stopPropagation(); prevCard(); }; navigationDiv.appendChild(prevBtn);

                } else if (index === TOTAL_CARDS - 1) { // FINISH
                    if (statementContents[index] !== undefined) {
                         contentDiv.textContent = statementContents[index];
                    } else { contentDiv.textContent = "Finish text missing."; }
                    optionsDiv.style.display = 'none';
                     // ... nav buttons setup ...
                     const prevBtn = document.createElement('button'); prevBtn.textContent = 'Previous'; prevBtn.onclick = (e) => { e.stopPropagation(); prevCard(); }; navigationDiv.appendChild(prevBtn);
                    const submitBtn = document.createElement('button'); submitBtn.id = 'submitBtn'; submitBtn.textContent = 'Submit Answers'; submitBtn.onclick = (e) => { e.stopPropagation(); submitData(); }; navigationDiv.appendChild(submitBtn);

                } else { // Fallback
                     contentDiv.textContent = `Error: Invalid card index ${index}.`;
                     optionsDiv.style.display = 'none';
                }

            }, 50); // End setTimeout
        }

        function validateEmail(email) {
            const re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            return re.test(String(email).toLowerCase());
        }

        function selectAnswer(cardIndex, option) {
            // ... answer saving and button styling ...
            const statementNumber = cardIndex - 1;
            const statementKey = 's' + statementNumber;
            answers[statementKey] = option;
            const currentOptionsDiv = document.getElementById('options');
            if (currentOptionsDiv) {
                const buttons = currentOptionsDiv.querySelectorAll('button');
                buttons.forEach(btn => { btn.classList.toggle('selected', btn.textContent === option); });
            }

            setTimeout(() => {
                if (currentIndex < TOTAL_CARDS - 1) {
                    nextCard();
                }
            }, 250);
        }

        function nextCard() {
            if (currentIndex < TOTAL_CARDS - 1) {
                loadCard(currentIndex + 1);
            }
        }

        function prevCard() {
            if (currentIndex > 0) {
                loadCard(currentIndex - 1);
            }
        }

        function submitData() {
           // ... submit logic remains the same ...
            const submitBtn = document.getElementById('submitBtn');
            statusP.textContent = 'Submitting...'; statusP.style.color = 'black';
            if (submitBtn) submitBtn.disabled = true;
            const finalData = { email: userEmail, ...answers };
            console.log('Submitting final data:', JSON.stringify(finalData));
            if (!userEmail) { statusP.textContent = 'Email is missing. Please go back.'; statusP.style.color = '#d32f2f'; if (submitBtn) submitBtn.disabled = false; loadCard(1); return; }
            let answeredCount = 0;
            for (let i = 1; i <= NUM_STATEMENTS; i++) { if (answers['s' + i]) { answeredCount++; } }
            if (answeredCount < NUM_STATEMENTS) { statusP.textContent = `Please answer all ${NUM_STATEMENTS} statements. (${answeredCount}/${NUM_STATEMENTS} answered)`; statusP.style.color = '#fb8c00'; if (submitBtn) submitBtn.disabled = false; return; }
            fetch(scriptURL, { redirect: "follow", method: 'POST', headers: { 'Content-Type': 'text/plain;charset=utf-8' }, body: JSON.stringify(finalData) })
            .then(response => { if (!response.ok) { return response.text().then(text => { throw new Error(`HTTP error ${response.status}: ${response.statusText} - ${text || 'No server details'}`); }); } const contentType = response.headers.get("content-type"); if (contentType && contentType.indexOf("application/json") !== -1) { return response.json(); } else { return response.text().then(text => { try { return JSON.parse(text); } catch (e) { console.log("Received non-JSON response, assuming success:", text); return { result: 'success', message: 'Submission received (interpreted).' }; } }); } })
            .then(data => { console.log('Success/Result Data:', data); if (data && data.result === 'success') { statusP.textContent = data.message || 'Success! Data submitted.'; statusP.style.color = '#388e3c'; const cardContainer = document.querySelector('.card-container'); if (cardContainer) cardContainer.style.display = 'none'; if (navigationDiv) navigationDiv.style.display = 'none'; } else { statusP.textContent = `Submission issue: ${data.message || 'Unknown status received.'}`; statusP.style.color = '#fb8c00'; if (submitBtn) submitBtn.disabled = false; } })
            .catch(error => { console.error('Fetch Error:', error); statusP.textContent = `Error: ${error.message}. Please check connection and try again.`; statusP.style.color = '#d32f2f'; if (submitBtn) submitBtn.disabled = false; });
        }


        // --- Initial Load and Event Listener ---
        window.onload = () => {
            if (cardElement) {
                 cardElement.onclick = flipCard;
            } else { console.error("Card element not found on load."); }
            loadCard(0); // Load the first card
        };
    </script>

</body>
</html>
